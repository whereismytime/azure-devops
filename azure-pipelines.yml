# Azure DevOps YAML pipeline using self-hosted agent 'ANDY' in 'MyHostedPool'

trigger:
  - main  # ğŸ” Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¸ Ğ¿ÑƒÑˆĞµ Ğ² Ğ²ĞµÑ‚ĞºÑƒ main

pool:
  name: MyHostedPool
  demands:
    - Agent.Name -equals ANDY

steps:
  - script: echo Hello from ANDY agent!
    displayName: 'ğŸ‘‹ Greeting step'

  - script: |
      echo ğŸ” Searching for .sln or .csproj...
      setlocal enabledelayedexpansion
      set "targetFile="
      for %%f in (*.sln) do (
        set "targetFile=%%f"
        goto :found
      )
      for /r %%f in (*.csproj) do (
        set "targetFile=%%f"
        goto :found
      )
      echo âš ï¸ No .sln or .csproj file found. Skipping build step.
      exit /b 0
      :found
      echo âœ… Found: !targetFile!
      dotnet build "!targetFile!" --configuration Release
    displayName: 'ğŸ”¨ Auto-detect & Build (optional)'

  - script: |
      echo ğŸ§ª Running tests...
      dotnet test --no-build || echo âš ï¸ No test project found or test failed.
    displayName: 'âœ… Run unit tests (optional)'
